import{d as C,r as c,a as L,o as M,c as s,b as a,e,w as y,v as V,u as d,f as p,g as i,F as N,h as S,n as k,t as o}from"./266V56LC.js";const B={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},D={class:"bg-white dark:bg-gray-800 shadow rounded-lg"},T={class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},U={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},z={class:"overflow-hidden"},F={key:0,class:"px-6 py-8 text-center"},O={key:1,class:"px-6 py-8 text-center"},j={key:2,class:"divide-y divide-gray-200 dark:divide-gray-700"},q={class:"flex items-start space-x-3"},E={class:"flex-1 min-w-0"},J={class:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400 mb-1"},$={key:0,class:"text-blue-600 dark:text-blue-400"},A={key:1,class:"text-green-600 dark:text-green-400"},G={class:"text-gray-900 dark:text-white"},H={key:0,class:"mt-2 p-3 bg-red-50 dark:bg-red-900/20 rounded-md"},I={class:"text-sm font-medium text-red-800 dark:text-red-400"},K={key:0,class:"mt-2 text-xs text-red-700 dark:text-red-300 whitespace-pre-wrap"},P={key:1,class:"mt-2"},Q={class:"text-sm"},R={class:"mt-2 p-3 bg-gray-50 dark:bg-gray-700 rounded-md text-xs overflow-x-auto"},W={key:3,class:"px-6 py-4 border-t border-gray-200 dark:border-gray-700"},X=["disabled"],ee=C({__name:"logs",setup(Y){const u=c([]),x=c(!1),m=c(!1),b=c(0),n=L({level:[],service:"",search:"",limit:50}),g=async(l=!0)=>{l&&(b.value=0,u.value=[]),x.value=!0;try{const r={...n,offset:b.value},t=await $fetch("/api/logs",{query:r});l?u.value=t.logs:u.value.push(...t.logs),m.value=t.hasMore,b.value+=t.logs.length}catch(r){console.error("加载日志失败:",r)}finally{x.value=!1}},v=()=>{g(!1)},f=()=>{g(!0)},h=l=>{const r={error:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",warn:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",info:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",debug:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"};return r[l]||r.info},w=l=>({error:"错误",warn:"警告",info:"信息",debug:"调试"})[l]||l,_=l=>new Date(l).toLocaleString("zh-CN");return M(()=>{g()}),(l,r)=>(a(),s("div",B,[e("div",D,[r[10]||(r[10]=e("div",{class:"px-6 py-4 border-b border-gray-200 dark:border-gray-700"},[e("h1",{class:"text-2xl font-semibold text-gray-900 dark:text-white"},"系统日志"),e("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"},"查看和管理系统运行日志")],-1)),e("div",T,[e("div",U,[e("div",null,[r[4]||(r[4]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"日志级别",-1)),y(e("select",{"onUpdate:modelValue":r[0]||(r[0]=t=>d(n).level=t),multiple:"",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500"},[...r[3]||(r[3]=[e("option",{value:"error"},"错误",-1),e("option",{value:"warn"},"警告",-1),e("option",{value:"info"},"信息",-1),e("option",{value:"debug"},"调试",-1)])],512),[[V,d(n).level]])]),e("div",null,[r[5]||(r[5]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"服务",-1)),y(e("input",{"onUpdate:modelValue":r[1]||(r[1]=t=>d(n).service=t),type:"text",placeholder:"输入服务名",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[p,d(n).service]])]),e("div",null,[r[6]||(r[6]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"搜索",-1)),y(e("input",{"onUpdate:modelValue":r[2]||(r[2]=t=>d(n).search=t),type:"text",placeholder:"搜索日志内容",class:"w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[p,d(n).search]])]),e("div",{class:"flex items-end space-x-2"},[e("button",{onClick:g,class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium"}," 搜索 "),e("button",{onClick:f,class:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md text-sm font-medium"}," 刷新 ")])])]),e("div",z,[d(x)?(a(),s("div",F,[...r[7]||(r[7]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),e("p",{class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},"加载中...",-1)])])):d(u).length===0?(a(),s("div",O,[...r[8]||(r[8]=[e("p",{class:"text-gray-600 dark:text-gray-400"},"暂无日志数据",-1)])])):(a(),s("div",j,[(a(!0),s(N,null,S(d(u),t=>(a(),s("div",{key:t.id,class:"px-6 py-4 hover:bg-gray-50 dark:hover:bg-gray-700"},[e("div",q,[e("span",{class:k([h(t.level),"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},o(w(t.level)),3),e("div",E,[e("div",J,[e("span",null,o(_(t.timestamp)),1),t.service?(a(),s("span",$,o(t.service),1)):i("",!0),t.method&&t.url?(a(),s("span",A,o(t.method)+" "+o(t.url),1)):i("",!0),t.statusCode?(a(),s("span",{key:2,class:k(t.statusCode>=400?"text-red-600":"text-green-600")},o(t.statusCode),3)):i("",!0)]),e("p",G,o(t.message),1),t.error?(a(),s("div",H,[e("p",I,o(t.error.name)+": "+o(t.error.message),1),t.error.stack?(a(),s("pre",K,o(t.error.stack),1)):i("",!0)])):i("",!0),t.metadata&&Object.keys(t.metadata).length>0?(a(),s("div",P,[e("details",Q,[r[9]||(r[9]=e("summary",{class:"cursor-pointer text-gray-600 dark:text-gray-400"},"元数据",-1)),e("pre",R,o(JSON.stringify(t.metadata,null,2)),1)])])):i("",!0)])])]))),128))])),d(m)?(a(),s("div",W,[e("button",{onClick:v,disabled:d(x),class:"w-full bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white px-4 py-2 rounded-md text-sm font-medium disabled:opacity-50"}," 加载更多 ",8,X)])):i("",!0)])])]))}});export{ee as default};
