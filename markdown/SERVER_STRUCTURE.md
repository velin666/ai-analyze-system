# Server ç›®å½•ç»“æ„å½’ç±»

é‡æ–°ç»„ç»‡åçš„æœåŠ¡å™¨ç«¯ä»£ç ç»“æ„ï¼ŒæŒ‰åŠŸèƒ½æ¨¡å—è¿›è¡Œåˆ†ç±»ç®¡ç†ã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
server/
â”œâ”€â”€ api/                           # API è·¯ç”±ç›®å½•
â”‚   â”œâ”€â”€ analyze/                   # ğŸ” åˆ†æåŠŸèƒ½æ¨¡å—
â”‚   â”‚   â””â”€â”€ [id].post.ts          # æ–‡ä»¶åˆ†æAPI
â”‚   â”‚
â”‚   â”œâ”€â”€ dashboard/                 # ğŸ“Š ä»ªè¡¨ç›˜æ¨¡å—  
â”‚   â”‚   â””â”€â”€ stats.get.ts          # ç»Ÿè®¡æ•°æ®API
â”‚   â”‚
â”‚   â”œâ”€â”€ files/                     # ğŸ“ æ–‡ä»¶ç®¡ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ [id]/                 # ç‰¹å®šæ–‡ä»¶æ“ä½œ
â”‚   â”‚   â”‚   â”œâ”€â”€ analysis.get.ts   # è·å–æ–‡ä»¶åˆ†æç»“æœ
â”‚   â”‚   â”‚   â””â”€â”€ preview.get.ts    # æ–‡ä»¶é¢„è§ˆ
â”‚   â”‚   â”œâ”€â”€ [id].delete.ts        # åˆ é™¤ç‰¹å®šæ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ index.get.ts          # è·å–æ–‡ä»¶åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ index.delete.ts       # æ‰¹é‡åˆ é™¤æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ upload.post.ts        # æ–‡ä»¶ä¸Šä¼ 
â”‚   â”‚
â”‚   â”œâ”€â”€ logs/                      # ğŸ“ æ—¥å¿—ç®¡ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ index.get.ts          # è·å–æ—¥å¿—æ•°æ® (æ”¯æŒè¿‡æ»¤)
â”‚   â”‚   â”œâ”€â”€ index.delete.ts       # åˆ é™¤æ—¥å¿—æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ files.get.ts          # è·å–æ—¥å¿—æ–‡ä»¶åˆ—è¡¨
â”‚   â”‚
â”‚   â””â”€â”€ system/                    # âš™ï¸ ç³»ç»ŸåŠŸèƒ½æ¨¡å—
â”‚       â””â”€â”€ test-logs.post.ts     # æµ‹è¯•æ—¥å¿—ç”Ÿæˆ
â”‚
â””â”€â”€ utils/                         # ğŸ› ï¸ å·¥å…·å‡½æ•°ç›®å½•
    â”œâ”€â”€ deepseek.ts               # DeepSeek AI æœåŠ¡
    â””â”€â”€ logger.ts                 # æ—¥å¿—å·¥å…·å‡½æ•°
```

## ğŸ¯ åŠŸèƒ½æ¨¡å—è¯´æ˜

### 1. åˆ†æåŠŸèƒ½æ¨¡å— (`/api/analyze/`)
**ç”¨é€”**ï¼šæ–‡ä»¶å†…å®¹åˆ†æå’Œ AI å¤„ç†
- `[id].post.ts` - å¯¹æŒ‡å®šæ–‡ä»¶è¿›è¡Œ AI åˆ†æ
- é›†æˆäº†è¯¦ç»†çš„æ—¥å¿—è®°å½•
- æ”¯æŒå¤šç§æ–‡ä»¶ç±»å‹åˆ†æ

**API ç«¯ç‚¹**ï¼š
- `POST /api/analyze/{fileId}` - åˆ†ææ–‡ä»¶

### 2. ä»ªè¡¨ç›˜æ¨¡å— (`/api/dashboard/`)
**ç”¨é€”**ï¼šç³»ç»Ÿæ¦‚è§ˆå’Œç»Ÿè®¡æ•°æ®
- `stats.get.ts` - æä¾›ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯

**API ç«¯ç‚¹**ï¼š
- `GET /api/dashboard/stats` - è·å–ç³»ç»Ÿç»Ÿè®¡

### 3. æ–‡ä»¶ç®¡ç†æ¨¡å— (`/api/files/`)
**ç”¨é€”**ï¼šæ–‡ä»¶çš„ä¸Šä¼ ã€ä¸‹è½½ã€åˆ é™¤å’Œç®¡ç†
- `upload.post.ts` - æ–‡ä»¶ä¸Šä¼ å¤„ç†
- `index.get.ts` - æ–‡ä»¶åˆ—è¡¨æŸ¥è¯¢
- `index.delete.ts` - æ‰¹é‡æ–‡ä»¶åˆ é™¤
- `[id].delete.ts` - å•ä¸ªæ–‡ä»¶åˆ é™¤
- `[id]/analysis.get.ts` - è·å–æ–‡ä»¶åˆ†æç»“æœ
- `[id]/preview.get.ts` - æ–‡ä»¶é¢„è§ˆ

**API ç«¯ç‚¹**ï¼š
- `POST /api/files/upload` - ä¸Šä¼ æ–‡ä»¶
- `GET /api/files` - è·å–æ–‡ä»¶åˆ—è¡¨
- `DELETE /api/files` - æ‰¹é‡åˆ é™¤æ–‡ä»¶
- `DELETE /api/files/{id}` - åˆ é™¤æŒ‡å®šæ–‡ä»¶
- `GET /api/files/{id}/analysis` - è·å–æ–‡ä»¶åˆ†æ
- `GET /api/files/{id}/preview` - é¢„è§ˆæ–‡ä»¶

### 4. æ—¥å¿—ç®¡ç†æ¨¡å— (`/api/logs/`)
**ç”¨é€”**ï¼šç³»ç»Ÿæ—¥å¿—çš„æŸ¥çœ‹ã€è¿‡æ»¤å’Œç®¡ç†
- `index.get.ts` - æ—¥å¿—æ•°æ®æŸ¥è¯¢å’Œè¿‡æ»¤
- `index.delete.ts` - æ—¥å¿—æ–‡ä»¶åˆ é™¤
- `files.get.ts` - æ—¥å¿—æ–‡ä»¶ä¿¡æ¯è·å–

**API ç«¯ç‚¹**ï¼š
- `GET /api/logs` - è·å–æ—¥å¿—æ•°æ®ï¼ˆæ”¯æŒè¿‡æ»¤ï¼‰
- `DELETE /api/logs` - åˆ é™¤æ—¥å¿—æ–‡ä»¶
- `GET /api/logs/files` - è·å–æ—¥å¿—æ–‡ä»¶åˆ—è¡¨

### 5. ç³»ç»ŸåŠŸèƒ½æ¨¡å— (`/api/system/`)
**ç”¨é€”**ï¼šç³»ç»Ÿçº§åˆ«çš„åŠŸèƒ½å’Œæµ‹è¯•
- `test-logs.post.ts` - ç”Ÿæˆæµ‹è¯•æ—¥å¿—æ•°æ®

**API ç«¯ç‚¹**ï¼š
- `POST /api/system/test-logs` - ç”Ÿæˆæµ‹è¯•æ—¥å¿—

### 6. å·¥å…·å‡½æ•° (`/utils/`)
**ç”¨é€”**ï¼šå¯å¤ç”¨çš„æœåŠ¡å’Œå·¥å…·å‡½æ•°
- `deepseek.ts` - DeepSeek AI æœåŠ¡å°è£…
- `logger.ts` - ç»Ÿä¸€çš„æ—¥å¿—è®°å½•å·¥å…·

## ğŸ”„ è¿ç§»è®°å½•

### æ–‡ä»¶ç§»åŠ¨æ˜ å°„
| åŸè·¯å¾„ | æ–°è·¯å¾„ | è¯´æ˜ |
|--------|--------|------|
| `api/files.get.ts` | `api/files/index.get.ts` | æ–‡ä»¶åˆ—è¡¨æŸ¥è¯¢ |
| `api/files.delete.ts` | `api/files/index.delete.ts` | æ‰¹é‡æ–‡ä»¶åˆ é™¤ |
| `api/upload.post.ts` | `api/files/upload.post.ts` | æ–‡ä»¶ä¸Šä¼  |
| `api/logs.get.ts` | `api/logs/index.get.ts` | æ—¥å¿—æŸ¥è¯¢ |
| `api/logs.delete.ts` | `api/logs/index.delete.ts` | æ—¥å¿—åˆ é™¤ |
| `api/log-files.get.ts` | `api/logs/files.get.ts` | æ—¥å¿—æ–‡ä»¶åˆ—è¡¨ |
| `api/test-logs.post.ts` | `api/system/test-logs.post.ts` | æµ‹è¯•æ—¥å¿—ç”Ÿæˆ |

## ğŸ“‹ ä¼˜åŠ¿

1. **æ¸…æ™°çš„æ¨¡å—åˆ’åˆ†**ï¼šæ¯ä¸ªåŠŸèƒ½æœ‰ç‹¬ç«‹çš„ç›®å½•
2. **æ˜“äºç»´æŠ¤**ï¼šç›¸å…³åŠŸèƒ½é›†ä¸­ç®¡ç†
3. **ä¾¿äºæ‰©å±•**ï¼šæ–°åŠŸèƒ½å¯ä»¥è½»æ¾æ·»åŠ åˆ°å¯¹åº”æ¨¡å—
4. **æé«˜å¼€å‘æ•ˆç‡**ï¼šå¼€å‘è€…å¯ä»¥å¿«é€Ÿå®šä½ç›¸å…³ä»£ç 
5. **RESTful è®¾è®¡**ï¼šç¬¦åˆç°ä»£APIè®¾è®¡è§„èŒƒ

## ğŸš€ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°çš„ API ç«¯ç‚¹
1. ç¡®å®šåŠŸèƒ½æ‰€å±æ¨¡å—
2. åœ¨å¯¹åº”çš„æ¨¡å—ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶
3. éµå¾ªå‘½åè§„èŒƒï¼š`åŠŸèƒ½å.æ–¹æ³•.ts`
4. æ›´æ–°æ­¤æ–‡æ¡£è¯´æ˜

### å‘½åè§„èŒƒ
- **ç›®å½•å**ï¼šä½¿ç”¨å¤æ•°å½¢å¼ï¼Œå¦‚ `files/`, `logs/`
- **æ–‡ä»¶å**ï¼š`åŠŸèƒ½å.HTTPæ–¹æ³•.ts`ï¼Œå¦‚ `index.get.ts`, `upload.post.ts`
- **å‚æ•°è·¯ç”±**ï¼šä½¿ç”¨ `[å‚æ•°å].æ–¹æ³•.ts` æ ¼å¼

---

**å½’ç±»å®Œæˆï¼** ğŸ‰ ç°åœ¨æœåŠ¡å™¨ä»£ç ç»“æ„æ›´åŠ æ¸…æ™°ï¼Œä¾¿äºç»´æŠ¤å’Œæ‰©å±•ã€‚
